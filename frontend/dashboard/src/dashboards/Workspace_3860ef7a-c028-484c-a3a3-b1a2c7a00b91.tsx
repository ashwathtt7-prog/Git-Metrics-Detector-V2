{
  "component_name": "WorkspaceDashboard",
  "code": "import React, { useMemo } from 'react';\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell, LineChart, Line } from 'recharts';\nimport { Users, Code, Activity, Server, GitBranch, AlertCircle, CheckCircle, TrendingUp, Clock, Shield, Mail, MessageSquare, CreditCard, Package, Database } from 'lucide-react';\n\n// Helper function to parse percentage values\nconst parsePercentage = (value) => {\n    if (typeof value === 'string' && value.includes('%')) {\n        return parseFloat(value.replace('%', ''));\n    }\n    return parseFloat(value);\n};\n\n// Helper function to parse estimated value strings for charts\nconst parseEstimatedValueForChart = (estimatedValue) => {\n    if (!estimatedValue || typeof estimatedValue !== 'string') return [];\n\n    const parts = estimatedValue.split(', ').map(part => part.trim());\n    return parts.map(part => {\n        const [percentageStr, label] = part.split(' ').filter(Boolean);\n        const percentage = parseFloat(percentageStr.replace('%', ''));\n        return { name: label.replace('within ', '').replace('>', ''), value: percentage };\n    });\n};\n\n\nconst WorkspaceDashboard = ({ metrics }) => {\n    const processedMetrics = useMemo(() => {\n        const data = {};\n        metrics.forEach(m => {\n            data[m.name] = {\n                value: m.data_type === 'percentage' ? parsePercentage(m.estimated_value) : (m.data_type === 'number' ? parseFloat(m.estimated_value) : m.estimated_value),\n                display_value: m.estimated_value,\n                category: m.category,\n                description: m.description,\n                dataType: m.data_type\n            };\n        });\n        return data;\n    }, [metrics]);\n\n    // Extract specific metrics for display\n    const totalRegisteredUsers = processedMetrics[\"Total Registered Users\"];\n    const newRegistrations = processedMetrics[\"New User Registrations (Daily/Weekly/Monthly)\"];\n    const uniqueActiveUsers = processedMetrics[\"Unique Active Users (Daily/Monthly)\"];\n    const loginSuccessRate = processedMetrics[\"Login Success Rate\"];\n    const apiErrorRate = processedMetrics[\"API Error Rate (Overall)\"];\n    const apiResponseTimeP95 = processedMetrics[\"API Response Time (P95)\"];\n    const rateLimitTriggerCount = processedMetrics[\"Rate Limit Trigger Count\"];\n    const failedLoginAttempts = processedMetrics[\"Failed Login Attempts (Total)\"];\n    const otpGenerationSuccessRate = processedMetrics[\"OTP Generation & Delivery Success Rate\"];\n    const otpVerificationSuccessRate = processedMetrics[\"OTP Verification Success Rate\"];\n    const profileCompletionRate = processedMetrics[\"Profile Completion Rate\"];\n    const paymentMethodAdoptionRate = processedMetrics[\"Payment Method Adoption Rate\"];\n    const avgPaymentMethodsPerUser = processedMetrics[\"Average Payment Methods per User\"];\n    const codeTestCoverage = processedMetrics[\"Code Test Coverage (Overall)\"];\n    const dbConnectionHealth = processedMetrics[\"Database Connection Health\"];\n    const passwordResetSuccessRate = processedMetrics[\"Password Reset Success Rate\"];\n    const emailSmsSendingVolume = processedMetrics[\"Email/SMS Sending Volume\"];\n    const emailSmsDeliverySuccessRate = processedMetrics[\"Email/SMS Delivery Success Rate\"];\n    const otpExpirationRate = processedMetrics[\"OTP Expiration Rate\"];\n    const validationErrorRate = processedMetrics[\"Validation Error Rate\"];\n    const dbQueryErrorRate = processedMetrics[\"Database Query Error Rate\"];\n    const apiRequestVolume = processedMetrics[\"API Request Volume (Total)\"];\n    const verifiedUsersPercentage = processedMetrics[\"Verified Users Percentage\"];\n    const lastLoginActivityDistribution = processedMetrics[\"Last Login Activity Distribution\"];\n    const numberOfMobilePlansOffered = processedMetrics[\"Number of Mobile Plans Offered\"];\n\n    // Data for Last Login Activity Distribution Pie Chart\n    const lastLoginPieData = useMemo(() => {\n        if (lastLoginActivityDistribution && lastLoginActivityDistribution.display_value) {\n            return parseEstimatedValueForChart(lastLoginActivityDistribution.display_value);\n        }\n        return [];\n    }, [lastLoginActivityDistribution]);\n\n    const PIE_COLORS = ['#ef4444', '#f87171', '#fca5a5', '#fecaca']; // Red palette\n\n    // Helper for progress bar\n    const ProgressBar = ({ value, label, color = 'bg-red-500' }) => (\n        <div className=\"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700 mt-2\">\n            <div className={`${color} h-2.5 rounded-full`} style={{ width: `${value}%` }}></div>\n            <span className=\"text-xs text-gray-500 mt-1 block\">{label}</span>\n        </div>\n    );\n\n    // Card component for consistency\n    const MetricCard = ({ title, value, description, icon, className = '', children }) => (\n        <div className={`bg-white border border-gray-200 shadow-sm rounded-xl p-6 flex flex-col ${className}`}>\n            <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-lg font-semibold text-gray-800\">{title}</h3>\n                {icon && <div className=\"text-red-500\">{icon}</div>}\n            </div>\n            {value && <p className=\"text-3xl font-bold text-gray-900 mb-2\">{value}</p>}\n            {description && <p className=\"text-sm text-gray-500\">{description}</p>}\n            {children}\n        </div>\n    );\n\n    // KPI Card component (larger, more prominent)\n    const KPICard = ({ title, value, description, icon, trend = null }) => (\n        <div className=\"bg-white border border-gray-200 shadow-md rounded-xl p-6 flex flex-col justify-between h-full\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-lg font-semibold text-gray-800\">{title}</h3>\n                {icon && <div className=\"text-red-500\">{icon}</div>}\n            </div>\n            <p className=\"text-4xl font-extrabold text-gray-900 mb-2\">{value}</p>\n            {description && <p className=\"text-sm text-gray-500\">{description}</p>}\n            {trend && (\n                <div className=\"mt-4 flex items-center text-sm\">\n                    {trend.type === 'positive' ? (\n                        <TrendingUp className=\"h-4 w-4 text-green-500 mr-1\" />\n                    ) : (\n                        <TrendingUp className=\"h-4 w-4 text-red-500 rotate-180 mr-1\" />\n                    )}\n                    <span className={trend.type === 'positive' ? 'text-green-600' : 'text-red-600'}>{trend.value}</span>\n                    <span className=\"text-gray-500 ml-1\">{trend.label}</span>\n                </div>\n            )}\n        </div>\n    );\n\n    return (\n        <div className=\"min-h-screen bg-gray-50 p-8\">\n            <h1 className=\"text-4xl font-bold text-gray-800 mb-8\">Mobile Plan Management API Dashboard</h1>\n\n            {/* KPIs Section */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\n                {totalRegisteredUsers && (\n                    <KPICard\n                        title=\"Total Registered Users\"\n                        value={totalRegisteredUsers.display_value}\n                        description={totalRegisteredUsers.description}\n                        icon={<Users size={24} />}\n                    />\n                )}\n                {apiErrorRate && (\n                    <KPICard\n                        title=\"API Error Rate\"\n                        value={apiErrorRate.display_value}\n                        description={apiErrorRate.description}\n                        icon={<AlertCircle size={24} />}\n                        trend={{ type: apiErrorRate.value < 1 ? 'positive' : 'negative', value: apiErrorRate.display_value, label: 'target <1%' }}\n                    />\n                )}\n                {apiResponseTimeP95 && (\n                    <KPICard\n                        title=\"API Response Time (P95)\"\n                        value={apiResponseTimeP95.display_value}\n                        description={apiResponseTimeP95.description}\n                        icon={<Clock size={24} />}\n                        trend={{ type: parseFloat(apiResponseTimeP95.display_value) < 500 ? 'positive' : 'negative', value: apiResponseTimeP95.display_value, label: 'target <500ms' }}\n                    />\n                )}\n                {loginSuccessRate && (\n                    <KPICard\n                        title=\"Login Success Rate\"\n                        value={loginSuccessRate.display_value}\n                        description={loginSuccessRate.description}\n                        icon={<CheckCircle size={24} />}\n                        trend={{ type: loginSuccessRate.value > 95 ? 'positive' : 'negative', value: loginSuccessRate.display_value, label: 'target >95%' }}\n                    />\n                )}\n            </div>\n\n            {/* Main Dashboard Grid */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6\">\n\n                {/* Growth Metrics */}\n                <div className=\"lg:col-span-2 xl:col-span-2\">\n                    <MetricCard\n                        title=\"New User Registrations\"\n                        value={newRegistrations?.display_value || 'N/A'}\n                        description={newRegistrations?.description || ''}\n                        icon={<Users size={20} />}\n                    />\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Unique Active Users (Monthly)\"\n                        value={uniqueActiveUsers?.display_value || 'N/A'}\n                        description={uniqueActiveUsers?.description || ''}\n                        icon={<Activity size={20} />}\n                    />\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Verified Users\"\n                        value={verifiedUsersPercentage?.display_value || 'N/A'}\n                        description={verifiedUsersPercentage?.description || ''}\n                        icon={<Shield size={20} />}\n                    >\n                        {verifiedUsersPercentage && <ProgressBar value={verifiedUsersPercentage.value} label={`${verifiedUsersPercentage.value}% Verified`} />}\n                    </MetricCard>\n                </div>\n\n                {/* Engagement Metrics */}\n                <div className=\"lg:col-span-2 xl:col-span-2\">\n                    <MetricCard\n                        title=\"Last Login Activity Distribution\"\n                        description={lastLoginActivityDistribution?.description || ''}\n                        icon={<Clock size={20} />}\n                        className=\"h-full\"\n                    >\n                        {lastLoginPieData.length > 0 ? (\n                            <ResponsiveContainer width=\"100%\" height={200}>\n                                <PieChart>\n                                    <Pie\n                                        data={lastLoginPieData}\n                                        cx=\"50%\"\n                                        cy=\"50%\"\n                                        labelLine={false}\n                                        outerRadius={80}\n                                        fill=\"#8884d8\"\n                                        dataKey=\"value\"\n                                        nameKey=\"name\"\n                                        label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}\n                                    >\n                                        {lastLoginPieData.map((entry, index) => (\n                                            <Cell key={`cell-${index}`} fill={PIE_COLORS[index % PIE_COLORS.length]} />\n                                        ))}\n                                    </Pie>\n                                    <Tooltip formatter={(value) => `${value}%`} />\n                                    <Legend />\n                                </PieChart>\n                            </ResponsiveContainer>\n                        ) : (\n                            <p className=\"text-gray-500 text-center mt-4\">No data available for distribution.</p>\n                        )}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Profile Completion Rate\"\n                        value={profileCompletionRate?.display_value || 'N/A'}\n                        description={profileCompletionRate?.description || ''}\n                        icon={<Users size={20} />}\n                    >\n                        {profileCompletionRate && <ProgressBar value={profileCompletionRate.value} label={`${profileCompletionRate.value}% Complete`} />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Payment Method Adoption\"\n                        value={paymentMethodAdoptionRate?.display_value || 'N/A'}\n                        description={paymentMethodAdoptionRate?.description || ''}\n                        icon={<CreditCard size={20} />}\n                    >\n                        {paymentMethodAdoptionRate && <ProgressBar value={paymentMethodAdoptionRate.value} label={`${paymentMethodAdoptionRate.value}% Adopted`} />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"OTP Verification Success\"\n                        value={otpVerificationSuccessRate?.display_value || 'N/A'}\n                        description={otpVerificationSuccessRate?.description || ''}\n                        icon={<CheckCircle size={20} />}\n                    >\n                        {otpVerificationSuccessRate && <ProgressBar value={otpVerificationSuccessRate.value} label={`${otpVerificationSuccessRate.value}% Success`} />}\n                    </MetricCard>\n                </div>\n\n                {/* Performance Metrics */}\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Rate Limit Triggers\"\n                        value={rateLimitTriggerCount?.display_value || 'N/A'}\n                        description={rateLimitTriggerCount?.description || ''}\n                        icon={<AlertCircle size={20} />}\n                    />\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Failed Login Attempts\"\n                        value={failedLoginAttempts?.display_value || 'N/A'}\n                        description={failedLoginAttempts?.description || ''}\n                        icon={<AlertCircle size={20} />}\n                    />\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"OTP Generation Success\"\n                        value={otpGenerationSuccessRate?.display_value || 'N/A'}\n                        description={otpGenerationSuccessRate?.description || ''}\n                        icon={<CheckCircle size={20} />}\n                    >\n                        {otpGenerationSuccessRate && <ProgressBar value={otpGenerationSuccessRate.value} label={`${otpGenerationSuccessRate.value}% Success`} />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Email/SMS Sending Volume\"\n                        value={emailSmsSendingVolume?.display_value || 'N/A'}\n                        description={emailSmsSendingVolume?.description || ''}\n                        icon={<Mail size={20} />}\n                    />\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Email/SMS Delivery Success\"\n                        value={emailSmsDeliverySuccessRate?.display_value || 'N/A'}\n                        description={emailSmsDeliverySuccessRate?.description || ''}\n                        icon={<MessageSquare size={20} />}\n                    >\n                        {emailSmsDeliverySuccessRate && <ProgressBar value={emailSmsDeliverySuccessRate.value} label={`${emailSmsDeliverySuccessRate.value}% Success`} />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Validation Error Rate\"\n                        value={validationErrorRate?.display_value || 'N/A'}\n                        description={validationErrorRate?.description || ''}\n                        icon={<AlertCircle size={20} />}\n                    >\n                        {validationErrorRate && <ProgressBar value={validationErrorRate.value} label={`${validationErrorRate.value}% Errors`} color=\"bg-yellow-500\" />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Database Query Error Rate\"\n                        value={dbQueryErrorRate?.display_value || 'N/A'}\n                        description={dbQueryErrorRate?.description || ''}\n                        icon={<Database size={20} />}\n                    >\n                        {dbQueryErrorRate && <ProgressBar value={dbQueryErrorRate.value} label={`${dbQueryErrorRate.value}% Errors`} color=\"bg-red-600\" />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"API Request Volume (Total)\"\n                        value={apiRequestVolume?.display_value || 'N/A'}\n                        description={apiRequestVolume?.description || ''}\n                        icon={<Server size={20} />}\n                    />\n                </div>\n\n                {/* Other Important Metrics */}\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Code Test Coverage\"\n                        value={codeTestCoverage?.display_value || 'N/A'}\n                        description={codeTestCoverage?.description || ''}\n                        icon={<Code size={20} />}\n                    >\n                        {codeTestCoverage && <ProgressBar value={codeTestCoverage.value} label={`${codeTestCoverage.value}% Covered`} color=\"bg-blue-500\" />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"DB Connection Health\"\n                        value={dbConnectionHealth?.value ? 'Healthy' : 'Unhealthy'}\n                        description={dbConnectionHealth?.description || ''}\n                        icon={<Database size={20} />}\n                        className={dbConnectionHealth?.value ? 'border-green-300' : 'border-red-300'}\n                    >\n                        <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${dbConnectionHealth?.value ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>\n                            {dbConnectionHealth?.value ? <CheckCircle size={14} className=\"mr-1\" /> : <AlertCircle size={14} className=\"mr-1\" />}\n                            {dbConnectionHealth?.value ? 'Operational' : 'Critical'}\n                        </span>\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Password Reset Success\"\n                        value={passwordResetSuccessRate?.display_value || 'N/A'}\n                        description={passwordResetSuccessRate?.description || ''}\n                        icon={<Shield size={20} />}\n                    >\n                        {passwordResetSuccessRate && <ProgressBar value={passwordResetSuccessRate.value} label={`${passwordResetSuccessRate.value}% Success`} />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"OTP Expiration Rate\"\n                        value={otpExpirationRate?.display_value || 'N/A'}\n                        description={otpExpirationRate?.description || ''}\n                        icon={<Clock size={20} />}\n                    >\n                        {otpExpirationRate && <ProgressBar value={otpExpirationRate.value} label={`${otpExpirationRate.value}% Expired`} color=\"bg-orange-500\" />}\n                    </MetricCard>\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Avg. Payment Methods/User\"\n                        value={avgPaymentMethodsPerUser?.display_value || 'N/A'}\n                        description={avgPaymentMethodsPerUser?.description || ''}\n                        icon={<CreditCard size={20} />}\n                    />\n                </div>\n                <div className=\"lg:col-span-1 xl:col-span-1\">\n                    <MetricCard\n                        title=\"Mobile Plans Offered\"\n                        value={numberOfMobilePlansOffered?.display_value || 'N/A'}\n                        description={numberOfMobilePlansOffered?.description || ''}\n                        icon={<Package size={20} />}\n                    />\n                </div>\n\n            </div>\n        </div>\n    );\n};\n\nexport default WorkspaceDashboard;"
}