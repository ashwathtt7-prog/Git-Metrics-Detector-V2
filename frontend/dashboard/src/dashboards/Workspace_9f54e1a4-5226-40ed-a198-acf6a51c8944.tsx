{
  "component_code": "import React, { useMemo } from 'react';\nimport { BarChart, Bar, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell, LineChart, Line } from 'recharts';\nimport { Users, Code, Activity, Server, GitBranch, AlertCircle, CheckCircle, Clock, Database, ShoppingCart, Percent, Shield, Zap } from 'lucide-react';\n\n// Helper function to parse estimated_value\nconst parseValue = (valueString) => {\n    if (!valueString) return null;\n    // Remove non-numeric characters except for '.' and handle percentages\n    let cleaned = valueString.replace(/[^0-9.]/g, '');\n    if (valueString.includes('%')) {\n        return parseFloat(cleaned); // Keep as percentage\n    }\n    return parseFloat(cleaned);\n};\n\n// Helper to find a metric\nconst findMetric = (metrics, name) => {\n    const metric = metrics.find(m => m.name === name);\n    if (!metric) return null;\n    return {\n        ...metric,\n        value: parseValue(metric.estimated_value),\n        display_value: metric.estimated_value\n    };\n};\n\nconst DashboardCard = ({ title, value, description, icon: Icon, accentColor = 'text-red-500' }) => (\n    <div className=\"bg-white border border-gray-200 shadow-sm rounded-xl p-6 flex flex-col justify-between h-full\">\n        <div className=\"flex items-center justify-between mb-4\">\n            <h3 className=\"text-lg font-semibold text-gray-800\">{title}</h3>\n            {Icon && <Icon className={`w-6 h-6 ${accentColor}`} />}\n        </div>\n        <div className=\"flex-grow\">\n            <p className=\"text-4xl font-bold text-gray-900 mb-2\">{value}</p>\n            {description && <p className=\"text-sm text-gray-500\">{description}</p>}\n        </div>\n    </div>\n);\n\nconst PercentageCard = ({ title, value, description, icon: Icon, accentColor = 'text-red-500' }) => {\n    const percentage = value || 0;\n    const radius = 50;\n    const circumference = 2 * Math.PI * radius;\n    const strokeDashoffset = circumference - (percentage / 100) * circumference;\n\n    return (\n        <div className=\"bg-white border border-gray-200 shadow-sm rounded-xl p-6 flex flex-col justify-between h-full\">\n            <div className=\"flex items-center justify-between mb-4\">\n                <h3 className=\"text-lg font-semibold text-gray-800\">{title}</h3>\n                {Icon && <Icon className={`w-6 h-6 ${accentColor}`} />}\n            </div>\n            <div className=\"flex-grow flex items-center justify-center relative\">\n                <svg className=\"w-24 h-24 transform -rotate-90\" viewBox=\"0 0 120 120\">\n                    <circle\n                        className=\"text-gray-200\"\n                        strokeWidth=\"10\"\n                        stroke=\"currentColor\"\n                        fill=\"transparent\"\n                        r={radius}\n                        cx=\"60\"\n                        cy=\"60\"\n                    />\n                    <circle\n                        className={accentColor}\n                        strokeWidth=\"10\"\n                        strokeDasharray={circumference}\n                        strokeDashoffset={strokeDashoffset}\n                        strokeLinecap=\"round\"\n                        stroke=\"currentColor\"\n                        fill=\"transparent\"\n                        r={radius}\n                        cx=\"60\"\n                        cy=\"60\"\n                    />\n                </svg>\n                <span className=\"absolute text-2xl font-bold text-gray-900\">{`${percentage}%`}</span>\n            </div>\n            {description && <p className=\"text-sm text-gray-500 mt-4 text-center\">{description}</p>}\n        </div>\n    );\n};\n\nconst WorkspaceDashboard = ({ metrics: rawMetrics }) => {\n    const metrics = useMemo(() => {\n        return rawMetrics.map(m => ({\n            ...m,\n            value: parseValue(m.estimated_value),\n            display_value: m.estimated_value\n        }));\n    }, [rawMetrics]);\n\n    // Helper to get a specific metric\n    const getMetric = (name) => findMetric(metrics, name);\n\n    // KPIs\n    const totalRegisteredUsers = getMetric(\"Total Registered Users\");\n    const activeUserCount = getMetric(\"Active User Count (Daily/Monthly)\");\n    const apiResponseTime = getMetric(\"API Response Time (P95)\");\n    const apiErrorRate = getMetric(\"API Error Rate (5xx)\");\n    const mobilePlanPurchaseVolume = getMetric(\"Mobile Plan Purchase Volume\");\n    const activeMobilePlanSubscriptions = getMetric(\"Active Mobile Plan Subscriptions\");\n    const dbConnectionHealth = getMetric(\"Database Connection Health\");\n\n    // Growth\n    const newUserRegistrations = getMetric(\"New User Registrations (Daily/Weekly)\");\n    const userRetentionRate = getMetric(\"User Retention Rate (Monthly)\");\n\n    // Performance\n    const rateLimitViolations = getMetric(\"Rate Limit Violations (Total)\");\n    const testCoveragePercentage = getMetric(\"Test Coverage Percentage\");\n    const testSuitePassRate = getMetric(\"Test Suite Pass Rate\");\n    const dbQueryLatency = getMetric(\"Database Query Latency (P95)\");\n    const emailSmsSuccessRate = getMetric(\"Email/SMS Sending Success Rate\");\n\n    // Business\n    const paymentMethodAdoptionRate = getMetric(\"Payment Method Adoption Rate\");\n\n    // Engagement\n    const loginSuccessRate = getMetric(\"Login Success Rate\");\n    const otpVerificationSuccessRate = getMetric(\"OTP Verification Success Rate\");\n    const userProfileCompletionRate = getMetric(\"User Profile Completion Rate\");\n    const apiEndpointUsageFrequency = getMetric(\"API Endpoint Usage Frequency (Top 5)\");\n\n    // Security\n    const loginFailureRate = getMetric(\"Login Failure Rate (Invalid Credentials)\");\n\n    // Data for charts\n    const apiErrorRateData = useMemo(() => {\n        if (!apiErrorRate || apiErrorRate.value === null) return [];\n        const successRate = 100 - apiErrorRate.value;\n        return [\n            { name: 'Errors', value: apiErrorRate.value, fill: '#ef4444' },\n            { name: 'Success', value: successRate, fill: '#22c55e' }, // Green for success\n        ];\n    }, [apiErrorRate]);\n\n    const newUserRegistrationsData = useMemo(() => {\n        if (!newUserRegistrations || newUserRegistrations.value === null) return [];\n        return [{ name: 'New Users', value: newUserRegistrations.value }];\n    }, [newUserRegistrations]);\n\n    return (\n        <div className=\"min-h-screen bg-gray-50 p-6\">\n            <h1 className=\"text-3xl font-bold text-gray-800 mb-8\">Mobile Plan Management API Dashboard</h1>\n\n            {/* Key Performance Indicators */}\n            <section className=\"mb-8\">\n                <h2 className=\"text-2xl font-semibold text-gray-700 mb-4\">Key Performance Indicators</h2>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n                    {totalRegisteredUsers && (\n                        <DashboardCard\n                            title=\"Total Registered Users\"\n                            value={totalRegisteredUsers.display_value}\n                            description={totalRegisteredUsers.description}\n                            icon={Users}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {activeUserCount && (\n                        <DashboardCard\n                            title=\"Active Users (DAU)\"\n                            value={activeUserCount.display_value}\n                            description={activeUserCount.description}\n                            icon={Activity}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {mobilePlanPurchaseVolume && (\n                        <DashboardCard\n                            title=\"Plan Purchases (Daily)\"\n                            value={mobilePlanPurchaseVolume.display_value}\n                            description={mobilePlanPurchaseVolume.description}\n                            icon={ShoppingCart}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {activeMobilePlanSubscriptions && (\n                        <DashboardCard\n                            title=\"Active Subscriptions\"\n                            value={activeMobilePlanSubscriptions.display_value}\n                            description={activeMobilePlanSubscriptions.description}\n                            icon={CheckCircle}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {apiResponseTime && (\n                        <DashboardCard\n                            title=\"API Response Time (P95)\"\n                            value={apiResponseTime.display_value}\n                            description={apiResponseTime.description}\n                            icon={Clock}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {apiErrorRate && (\n                        <DashboardCard\n                            title=\"API Error Rate (5xx)\"\n                            value={apiErrorRate.display_value}\n                            description={apiErrorRate.description}\n                            icon={AlertCircle}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {dbConnectionHealth && (\n                        <DashboardCard\n                            title=\"DB Connection Health\"\n                            value={dbConnectionHealth.display_value.toUpperCase()}\n                            description={dbConnectionHealth.description}\n                            icon={Database}\n                            accentColor={dbConnectionHealth.value === 'healthy' ? 'text-green-500' : 'text-red-500'}\n                        />\n                    )}\n                </div>\n            </section>\n\n            {/* Growth & Engagement */}\n            <section className=\"mb-8\">\n                <h2 className=\"text-2xl font-semibold text-gray-700 mb-4\">Growth & Engagement</h2>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                    {newUserRegistrations && (\n                        <div className=\"bg-white border border-gray-200 shadow-sm rounded-xl p-6 h-full\">\n                            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">New User Registrations</h3>\n                            <ResponsiveContainer width=\"100%\" height={150}>\n                                <BarChart data={newUserRegistrationsData} margin={{ top: 5, right: 0, left: 0, bottom: 5 }}>\n                                    <XAxis dataKey=\"name\" hide />\n                                    <YAxis hide />\n                                    <Tooltip cursor={{ fill: 'transparent' }} />\n                                    <Bar dataKey=\"value\" fill=\"#ef4444\" radius={[5, 5, 0, 0]} />\n                                </BarChart>\n                            </ResponsiveContainer>\n                            <p className=\"text-3xl font-bold text-gray-900 text-center mt-2\">{newUserRegistrations.display_value}</p>\n                            <p className=\"text-sm text-gray-500 text-center mt-1\">{newUserRegistrations.description}</p>\n                        </div>\n                    )}\n                    {userRetentionRate && (\n                        <PercentageCard\n                            title=\"User Retention Rate (Monthly)\"\n                            value={userRetentionRate.value}\n                            description={userRetentionRate.description}\n                            icon={Percent}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {loginSuccessRate && (\n                        <PercentageCard\n                            title=\"Login Success Rate\"\n                            value={loginSuccessRate.value}\n                            description={loginSuccessRate.description}\n                            icon={CheckCircle}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {otpVerificationSuccessRate && (\n                        <PercentageCard\n                            title=\"OTP Verification Success Rate\"\n                            value={otpVerificationSuccessRate.value}\n                            description={otpVerificationSuccessRate.description}\n                            icon={Shield}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {userProfileCompletionRate && (\n                        <PercentageCard\n                            title=\"User Profile Completion Rate\"\n                            value={userProfileCompletionRate.value}\n                            description={userProfileCompletionRate.description}\n                            icon={Users}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {apiEndpointUsageFrequency && (\n                        <DashboardCard\n                            title=\"Top API Endpoint Usage\"\n                            value={apiEndpointUsageFrequency.display_value}\n                            description={apiEndpointUsageFrequency.description}\n                            icon={Zap}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                </div>\n            </section>\n\n            {/* System Performance & Reliability */}\n            <section className=\"mb-8\">\n                <h2 className=\"text-2xl font-semibold text-gray-700 mb-4\">System Performance & Reliability</h2>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                    {rateLimitViolations && (\n                        <DashboardCard\n                            title=\"Rate Limit Violations\"\n                            value={rateLimitViolations.display_value}\n                            description={rateLimitViolations.description}\n                            icon={AlertCircle}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {dbQueryLatency && (\n                        <DashboardCard\n                            title=\"DB Query Latency (P95)\"\n                            value={dbQueryLatency.display_value}\n                            description={dbQueryLatency.description}\n                            icon={Database}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {emailSmsSuccessRate && (\n                        <PercentageCard\n                            title=\"Email/SMS Success Rate\"\n                            value={emailSmsSuccessRate.value}\n                            description={emailSmsSuccessRate.description}\n                            icon={CheckCircle}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {testCoveragePercentage && (\n                        <PercentageCard\n                            title=\"Test Coverage\"\n                            value={testCoveragePercentage.value}\n                            description={testCoveragePercentage.description}\n                            icon={Code}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {testSuitePassRate && (\n                        <PercentageCard\n                            title=\"Test Suite Pass Rate\"\n                            value={testSuitePassRate.value}\n                            description={testSuitePassRate.description}\n                            icon={GitBranch}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {apiErrorRateData.length > 0 && ( // Only render if data is available\n                        <div className=\"bg-white border border-gray-200 shadow-sm rounded-xl p-6 h-full\">\n                            <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">API Error Distribution</h3>\n                            <ResponsiveContainer width=\"100%\" height={200}>\n                                <PieChart>\n                                    <Pie\n                                        data={apiErrorRateData}\n                                        cx=\"50%\"\n                                        cy=\"50%\"\n                                        innerRadius={60}\n                                        outerRadius={80}\n                                        fill=\"#8884d8\"\n                                        paddingAngle={5}\n                                        dataKey=\"value\"\n                                        labelLine={false}\n                                        label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}\n                                    >\n                                        {apiErrorRateData.map((entry, index) => (\n                                            <Cell key={`cell-${index}`} fill={entry.fill} />\n                                        ))}\n                                    </Pie>\n                                    <Tooltip />\n                                    <Legend />\n                                </PieChart>\n                            </ResponsiveContainer>\n                            <p className=\"text-sm text-gray-500 text-center mt-2\">Breakdown of API request outcomes.</p>\n                        </div>\n                    )}\n                </div>\n            </section>\n\n            {/* Business & Security */}\n            <section>\n                <h2 className=\"text-2xl font-semibold text-gray-700 mb-4\">Business & Security</h2>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n                    {paymentMethodAdoptionRate && (\n                        <PercentageCard\n                            title=\"Payment Method Adoption\"\n                            value={paymentMethodAdoptionRate.value}\n                            description={paymentMethodAdoptionRate.description}\n                            icon={Percent}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                    {loginFailureRate && (\n                        <DashboardCard\n                            title=\"Login Failure Rate\"\n                            value={loginFailureRate.display_value}\n                            description={loginFailureRate.description}\n                            icon={AlertCircle}\n                            accentColor=\"text-red-500\"\n                        />\n                    )}\n                </div>\n            </section>\n        </div>\n    );\n};\n\nexport default WorkspaceDashboard;"
}